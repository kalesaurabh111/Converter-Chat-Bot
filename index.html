/* Measurement Converter Chatbot (React) Single-file component ready to drop into a React app (Vite / Create React App / Next.js).

Features:

Modern, responsive chat UI using Tailwind CSS

Built-in AI-like natural language parsing for common conversion requests

Built-in conversion engine for length, mass, temperature, volume

Optional AI-enhanced mode (send messages to your backend / OpenAI) â€” instructions included

Placeholder for Google AdSense: instructions to add script to index.html and replace publisher ID


How to use:

1. Ensure Tailwind CSS is installed in your project (or adapt classes to your CSS).


2. Drop this file as MeasurementChatbot.jsx and import into a page: import Chatbot from './MeasurementChatbot'


3. (Optional) To enable AI-enhanced replies, create a backend endpoint /api/ai that accepts {message} and returns {reply}.


4. Add Google AdSense script to public/index.html and replace ca-pub-XXXXXXXXXXXX with your publisher ID.



AdSense snippet (paste in public/index.html <head>):

<!-- Google AdSense: replace ca-pub-XXXXXXXXXXXX with your publisher ID --><!--
<script data-ad-client="ca-pub-XXXXXXXXXXXX" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
-->Ad slot example (paste inside the component markup where you want the ad to appear):

{/* <ins className="adsbygoogle" style={{display:'block'}} data-ad-client="ca-pub-XXXXXXXXXXXX" data-ad-slot="1234567890" data-ad-format="auto" data-full-width-responsive="true"></ins>

<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>*/}

*/

import React, { useState, useRef, useEffect } from 'react'; import { ArrowRight } from 'lucide-react';

export default function MeasurementChatbot() { const [messages, setMessages] = useState([ { id: 1, from: 'bot', text: 'Hi ðŸ‘‹ I can convert measurements. Try: "convert 5 km to miles" or "how many cups in 2 liters?"' }, ]); const [input, setInput] = useState(''); const [isAiMode, setIsAiMode] = useState(false); // If true, sends to your AI endpoint instead of local converter const [loading, setLoading] = useState(false); const scrollRef = useRef(null);

useEffect(() => { if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight; }, [messages, loading]);

// --- Conversion engine --- const unitGroups = { length: { base: 'm', units: { m: 1, km: 1000, cm: 0.01, mm: 0.001, mi: 1609.344, yd: 0.9144, ft: 0.3048, in: 0.0254, }, }, mass: { base: 'kg', units: { kg: 1, g: 0.001, mg: 0.000001, lb: 0.45359237, oz: 0.028349523125, }, }, volume: { base: 'l', units: { l: 1, ml: 0.001, 'm^3': 1000, cup: 0.24, // approximate (metric cup) pint: 0.473176, quart: 0.946353, gallon: 3.78541, }, }, };

function findUnitCategory(unit) { unit = unit.toLowerCase(); for (const [cat, data] of Object.entries(unitGroups)) { if (data.units[unit]) return { cat, data }; } return null; }

function convertValue(value, from, to) { from = from.toLowerCase(); to = to.toLowerCase(); // special case: temperature if (['c', 'f', 'k', 'Â°c', 'Â°f'].includes(from) || ['c', 'f', 'k', 'Â°c', 'Â°f'].includes(to)) { return convertTemperature(value, from, to); }

const fromCat = findUnitCategory(from);
const toCat = findUnitCategory(to);
if (!fromCat || !toCat || fromCat.cat !== toCat.cat) return null;

const base = fromCat.data.base;
const units = fromCat.data.units;
const inBase = parseFloat(value) * units[from];
const target = inBase / units[to];
return target;

}

function convertTemperature(value, from, to) { const f = from.toLowerCase().replace('Â°', ''); const t = to.toLowerCase().replace('Â°', ''); let celsius; if (f === 'c') celsius = value; else if (f === 'f') celsius = (value - 32) * (5 / 9); else if (f === 'k') celsius = value - 273.15; else return null;

if (t === 'c') return celsius;
if (t === 'f') return celsius * 9 / 5 + 32;
if (t === 'k') return celsius + 273.15;
return null;

}

// --- Natural language parsing --- function parseConversionRequest(text) { // common patterns: "convert 5 km to miles", "how many miles is 5 km", "5 km in miles" const t = text.trim().toLowerCase();

// pattern: number + unit + to + unit
let m = t.match(/([0-9]*\.?[0-9]+)\s*([a-zÂ°^\/0-9]+)\s*(to|in|into|=|is)\s*([a-zÂ°^\/0-9]+)/i);
if (m) {
  return { value: parseFloat(m[1]), from: normalizeUnit(m[2]), to: normalizeUnit(m[4]) };
}

// pattern: how many UNIT in NUMBER UNIT
m = t.match(/how\s+many\s+([a-zÂ°^\/0-9]+)s?\s+(are\s+)?in\s+([0-9]*\.?[0-9]+)\s*([a-zÂ°^\/0-9]+)/i);
if (m) {
  return { value: parseFloat(m[3]), from: normalizeUnit(m[4]), to: normalizeUnit(m[1]) };
}

// pattern: NUMBER UNIT to UNIT (without 'convert')
m = t.match(/([0-9]*\.?[0-9]+)\s*([a-zÂ°^\/0-9]+)\s*to\s*([a-zÂ°^\/0-9]+)/i);
if (m) {
  return { value: parseFloat(m[1]), from: normalizeUnit(m[2]), to: normalizeUnit(m[3]) };
}

// fallback: try to find two units and a number
const nums = t.match(/([0-9]*\.?[0-9]+)/);
const units = t.match(/([a-zÂ°^\/0-9]+)/g) || [];
if (nums && units.length >= 2) {
  const num = parseFloat(nums[0]);
  // pick first and last units as from/to heuristics
  return { value: num, from: normalizeUnit(units[units.length - 2]), to: normalizeUnit(units[units.length - 1]) };
}

return null;

}

function normalizeUnit(raw) { raw = raw.trim().toLowerCase(); // common synonyms const map = { meters: 'm', meter: 'm', m: 'm', metres: 'm', kilometre: 'km', km: 'km', kilometers: 'km', km: 'km', cm: 'cm', centimeter: 'cm', centimetre: 'cm', mm: 'mm', millimeter: 'mm', millimetre: 'mm', miles: 'mi', mile: 'mi', mi: 'mi', yards: 'yd', yard: 'yd', yd: 'yd', feet: 'ft', foot: 'ft', ft: 'ft', inches: 'in', inch: 'in', in: 'in', kg: 'kg', kilogram: 'kg', kilograms: 'kg', g: 'g', gram: 'g', grams: 'g', lb: 'lb', lbs: 'lb', pound: 'lb', oz: 'oz', ounce: 'oz', l: 'l', liter: 'l', litre: 'l', liters: 'l', litres: 'l', ml: 'ml', cup: 'cup', cups: 'cup', pint: 'pint', quart: 'quart', gallon: 'gallon', c: 'c', 'Â°c': 'c', celsius: 'c', f: 'f', 'Â°f': 'f', fahrenheit: 'f', k: 'k', kelvin: 'k', }; if (map[raw]) return map[raw]; // cleanup characters return raw.replace(/[^a-z0-9^Â°]/g, ''); }

// --- Message handling --- async function handleSend(e) { e && e.preventDefault(); if (!input.trim()) return; const userText = input.trim(); const userMsg = { id: Date.now(), from: 'user', text: userText }; setMessages((m) => [...m, userMsg]); setInput('');

// If AI mode is on, send to backend; otherwise attempt local parse + conversion
setLoading(true);
if (isAiMode) {
  try {
    const botReply = await sendToAiBackend(userText);
    setMessages((m) => [...m, { id: Date.now() + 1, from: 'bot', text: botReply }]);
  } catch (err) {
    setMessages((m) => [...m, { id: Date.now() + 1, from: 'bot', text: "Sorry, AI backend error. Try local mode." }]);
  }
  setLoading(false);
  return;
}

// local mode
const parsed = parseConversionRequest(userText);
if (!parsed) {
  // couldn't parse â€” offer help
  setMessages((m) => [...m, { id: Date.now() + 1, from: 'bot', text: "I couldn't parse that. Try: 'convert 5 km to miles' or 'how many cups in 2 liters'" }]);
  setLoading(false);
  return;
}

const { value, from, to } = parsed;
const result = convertValue(value, from, to);
if (result === null || typeof result === 'undefined' || Number.isNaN(result)) {
  setMessages((m) => [...m, { id: Date.now() + 1, from: 'bot', text: `I can't convert from "${from}" to "${to}" â€” they might be different categories or unsupported.` }]);
  setLoading(false);
  return;
}

const pretty = formatNumber(result);
const botText = `${value} ${from} = ${pretty} ${to}`;
setMessages((m) => [...m, { id: Date.now() + 1, from: 'bot', text: botText }]);
setLoading(false);

}

function formatNumber(n) { if (Math.abs(n) < 0.0001) return n.toPrecision(4); if (Math.abs(n) < 1) return n.toPrecision(6); if (Math.abs(n) > 1000000) return n.toExponential(3); return Number.isInteger(n) ? n.toString() : Number.parseFloat(n).toFixed(6).replace(/.?(0+)$/, ''); }

async function sendToAiBackend(message) { // IMPORTANT: create a backend endpoint that calls OpenAI or any AI provider // Example POST shape: { message: string } -> { reply: string } // This file intentionally does NOT include an API key. const res = await fetch('/api/ai', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ message }), }); if (!res.ok) throw new Error('AI backend failed'); const j = await res.json(); return j.reply || 'No reply from AI.'; }

// --- small UI helpers --- function Example({ text }) { return ( <button onClick={() => setInput(text)} className="px-3 py-1 rounded-full bg-white/10 hover:bg-white/20 text-sm mr-2" > {text} </button> ); }

return ( <div className="max-w-3xl mx-auto p-4"> <div className="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-5 rounded-2xl shadow-2xl"> <div className="flex items-center justify-between mb-4"> <div> <h2 className="text-2xl font-bold">MeasureMate â€” AI Measurement Chatbot</h2> <p className="text-sm opacity-80">Convert units fast â€” or ask the AI for help. Modern UI, ready for AdSense.</p> </div> <div className="text-right text-xs opacity-90"> <div className="mb-1">Mode</div> <label className="inline-flex items-center gap-2 bg-white/10 px-3 py-1 rounded-full"> <input type="checkbox" checked={isAiMode} onChange={() => setIsAiMode((s) => !s)} /> <span className="text-sm">AI Mode</span> </label> </div> </div>

<div className="bg-white/5 rounded-lg p-4 mb-4" style={{ height: 420, overflow: 'auto' }} ref={scrollRef}>
      {messages.map((m) => (
        <div key={m.id} className={`flex mb-3 ${m.from === 'user' ? 'justify-end' : 'justify-start'}`}>
          <div className={`max-w-[80%] p-3 rounded-2xl ${m.from === 'user' ? 'bg-indigo-500 text-white' : 'bg-white/10 text-white'}`}>
            <div className="text-sm">{m.text}</div>
          </div>
        </div>
      ))}
      {loading && (
        <div className="flex mb-3 justify-start">
          <div className="max-w-[60%] p-3 rounded-2xl bg-white/10 text-white text-sm">Thinking...</div>
        </div>
      )}
    </div>

    {/* Ad placeholder: put an AdSense slot here if you want ads inside chat area */}
    <div className="mb-4 flex justify-center">
      {/* Example ad container (replace data-ad-client/data-ad-slot) */}
      <div className="w-full max-w-lg p-2 rounded bg-white/5 text-xs text-center">
        <div>Ad slot â€” paste AdSense <code>&lt;ins&gt;</code> here and replace publisher ID</div>
        <div className="mt-2 text-[11px] opacity-70">(See top of this file for instructions)</div>
      </div>
    </div>

    <form onSubmit={handleSend} className="flex gap-2">
      <input
        value={input}
        onChange={(e) => setInput(e.target.value)}
        placeholder={`Try: "convert 5 km to miles"`}
        className="flex-1 bg-white/5 rounded-full px-4 py-2 outline-none placeholder:text-white/60 text-white"
      />
      <button
        type="submit"
        className="bg-white text-indigo-700 px-4 rounded-full flex items-center gap-2 font-semibold"
      >
        Send <ArrowRight size={16} />
      </button>
    </form>

    <div className="mt-3 text-xs opacity-80">
      Quick examples: <Example text="convert 5 km to miles" /> <Example text="how many cups in 2 liters" /> <Example text="10 ft in m" />
    </div>
  </div>

  {/* Footer: credits and small docs */}
  <div className="mt-4 text-sm text-gray-600">
    <strong>Notes:</strong>
    <ul className="list-disc ml-5 mt-2">
      <li>To enable Google AdSense, add the script tag shown at the top into your <code>index.html</code> and insert an <code>&lt;ins className="adsbygoogle"&gt;</code> slot where you want ads to appear.</li>
      <li>If you enable AI Mode, implement a secure backend that holds your OpenAI (or other) API key and forwards messages. Don't put API keys into client-side code.</li>
      <li>The built-in converter supports common units. You can extend <code>unitGroups</code> to add more units/categories.</li>
    </ul>
  </div>
</div>

); }

